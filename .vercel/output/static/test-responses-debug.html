<!DOCTYPE html><html><head><title>OpenAI Responses API Debug Test</title><style>body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;max-width:1200px;margin:30px auto;padding:20px;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);min-height:100vh}.container{background:#fff;border-radius:12px;padding:30px;box-shadow:0 10px 40px rgba(0,0,0,.1)}h1{color:#333;margin-bottom:10px}.subtitle{color:#666;margin-bottom:30px}.test-section{margin:20px 0;padding:20px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}button{padding:12px 24px;margin:5px;cursor:pointer;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff;border:none;border-radius:6px;font-size:15px;font-weight:500;transition:transform .2s}button:hover{transform:translateY(-2px)}button:active{transform:translateY(0)}#results{margin-top:20px;padding:20px;background:#fff;border-radius:8px;min-height:200px;white-space:pre-wrap;font-family:'Courier New',monospace;font-size:13px;border:2px solid #e9ecef;max-height:600px;overflow-y:auto}.success{color:#28a745;font-weight:700}.error{color:#dc3545;font-weight:700}.warning{color:#ffc107;font-weight:700}.loading{color:#6c757d;font-style:italic}input{width:500px;padding:12px;font-size:15px;border:2px solid #e9ecef;border-radius:6px;margin-right:10px}input:focus{outline:0;border-color:#667eea}.info-box{background:#e7f3ff;border-left:4px solid #007bff;padding:15px;margin:20px 0;border-radius:4px}.section-title{font-size:18px;font-weight:600;color:#495057;margin-bottom:15px}.log-entry{padding:8px;margin:4px 0;border-radius:4px;background:#f8f9fa}.log-entry.api-call{background:#e3f2fd}.log-entry.api-response{background:#e8f5e9}.log-entry.error{background:#ffebee}</style></head><body><div class=container><h1>üîç OpenAI Responses API - Debug Console</h1><p class=subtitle>Testing web_search_preview tool with detailed response inspection</p><div class=info-box><strong>Purpose:</strong> This debug console tests the OpenAI Responses API with web_search_preview tool and displays the complete raw response to understand the actual data structure.</div><div class=test-section><div class=section-title>Quick Test Queries</div><button onclick="testSearch(&#34;current weather in New York City&#34;)">Weather in NYC</button> <button onclick="testSearch(&#34;latest news about OpenAI&#34;)">OpenAI News</button> <button onclick="testSearch(&#34;Tesla stock price today&#34;)">Tesla Stock</button> <button onclick="testSearch(&#34;best coffee shops in Seattle 2025&#34;)">Seattle Coffee</button> <button onclick="testSearch(&#34;how to use ChatGPT for business&#34;)">ChatGPT Business</button></div><div class=test-section><div class=section-title>Custom Query</div><input id=customQuery placeholder="Enter your search query..." type=text value="What is the population of Tokyo?"> <button onclick=testCustomSearch()>üîç Search</button></div><div class=test-section><div class=section-title>Debug Output</div><div id=results>Ready for testing...</div></div></div><script>let logCounter=0;function log(e,t="info"){const s=document.getElementById("results"),o=(new Date).toLocaleTimeString(),n=++logCounter;let r="",i="";switch(t){case"api-call":r="api-call",i="üì§ API CALL";break;case"api-response":r="api-response",i="üì• API RESPONSE";break;case"success":r="success",i="‚úÖ SUCCESS";break;case"error":r="error",i="‚ùå ERROR";break;case"warning":r="warning",i="‚ö†Ô∏è WARNING";break;case"loading":r="loading",i="‚è≥ LOADING";break;default:i="‚ÑπÔ∏è INFO"}const a=`[${o}] #${n} ${i}: ${e}\n`;"clear"===t?s.innerHTML=e:s.innerHTML+=`<span class="${r}">${a}</span>`,s.scrollTop=s.scrollHeight}async function testSearch(e){log("","clear"),log(`Starting search for: "${e}"`,"loading");const t=Date.now();try{log("Calling our /api/voice-agent/responses-search endpoint...","api-call");const s=await fetch("/api/voice-agent/responses-search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,conversationContext:"Testing web search functionality in debug mode"})});log(`Response received in ${Date.now()-t}ms`,"api-response");const o=await s.text();let n;log(`Raw response text:\n${o}`,"info");try{n=JSON.parse(o),log("Successfully parsed JSON response","success")}catch(e){return void log(`Failed to parse JSON: ${e.message}`,"error")}log("Parsed response structure:","info"),log(`- success: ${n.success}`,"info"),log("- response: "+(n.response?n.response.substring(0,200)+"...":"null"),"info"),log("- searchResults: "+(n.searchResults?n.searchResults.length+" results":"null"),"info"),log("- citations: "+(n.citations?n.citations.length+" citations":"null"),"info"),n.searchResults&&n.searchResults.length>0?(log("\nSearch Results:","success"),n.searchResults.forEach(((e,t)=>{log(`\n[Result ${t+1}]`,"info"),log(`Title: ${e.title}`,"info"),log(`URL: ${e.url}`,"info"),log(`Snippet: ${e.snippet}`,"info"),log(`Source: ${e.source}`,"info")}))):(log("\n‚ö†Ô∏è No search results returned!","warning"),log("This indicates the OpenAI API is not returning search data.","warning")),n.citations&&n.citations.length>0&&(log("\nCitations:","success"),n.citations.forEach(((e,t)=>{log(`[${t+1}] ${e.title} - ${e.url}`,"info")}))),log("\n=== COMPLETE RESPONSE DATA ===","info"),log(JSON.stringify(n,null,2),"info"),log("\n=== TESTING DIRECT OPENAI API CALL ===","api-call"),await testDirectOpenAI(e)}catch(e){log(`Request failed: ${e.message}`,"error"),log(`Stack trace:\n${e.stack}`,"error")}}async function testDirectOpenAI(e){log("Note: Direct API calls from browser will fail due to CORS.","warning"),log("This is expected. The server-side implementation should work.","info");const t={model:"gpt-4o",input:[{role:"user",content:[{type:"input_text",text:e}]}],tools:[{type:"web_search_preview"}],tool_choice:{type:"web_search_preview"}};log("Request body that would be sent to OpenAI:","info"),log(JSON.stringify(t,null,2),"info")}function testCustomSearch(){const e=document.getElementById("customQuery").value;e&&testSearch(e)}document.getElementById("customQuery").addEventListener("keypress",(function(e){"Enter"===e.key&&testCustomSearch()})),window.addEventListener("load",(()=>{log("Debug console ready. Click a button to test the search functionality.","success")}))</script></body></html>