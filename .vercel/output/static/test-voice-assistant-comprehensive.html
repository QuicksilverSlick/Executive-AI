<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><title>Voice Assistant Comprehensive Test Suite</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#f8fafc;color:#1e293b;line-height:1.6}.test-container{max-width:1200px;margin:0 auto;padding:20px}.header{text-align:center;margin-bottom:40px;padding:30px;background:#fff;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,.1)}.header h1{color:#1e40af;margin-bottom:10px;font-size:2.5rem;font-weight:700}.header p{color:#64748b;font-size:1.1rem}.test-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:24px;margin-bottom:40px}.test-section{background:#fff;border-radius:12px;padding:24px;box-shadow:0 4px 6px -1px rgba(0,0,0,.1);border:1px solid #e2e8f0}.test-section h2{color:#1e40af;margin-bottom:16px;font-size:1.5rem;font-weight:600;display:flex;align-items:center;gap:8px}.test-section h2::before{content:'🧪';font-size:1.2rem}.test-button{background:linear-gradient(135deg,#3b82f6 0,#1d4ed8 100%);color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-weight:500;margin:6px;transition:all .2s ease;min-width:140px}.test-button:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(59,130,246,.3)}.test-button:active{transform:translateY(0)}.test-button.secondary{background:linear-gradient(135deg,#6b7280 0,#4b5563 100%)}.test-button.danger{background:linear-gradient(135deg,#ef4444 0,#dc2626 100%)}.test-button.success{background:linear-gradient(135deg,#10b981 0,#059669 100%)}.status-panel{background:#f1f5f9;border-radius:8px;padding:16px;margin:16px 0;border-left:4px solid #3b82f6}.status-panel.success{background:#f0fdf4;border-left-color:#10b981}.status-panel.error{background:#fef2f2;border-left-color:#ef4444}.status-panel.warning{background:#fffbeb;border-left-color:#f59e0b}.results-container{background:#f8fafc;border-radius:8px;padding:16px;margin-top:16px;max-height:300px;overflow-y:auto;border:1px solid #e2e8f0}.result-item{padding:8px 12px;margin:4px 0;border-radius:6px;display:flex;align-items:center;gap:8px;font-size:.9rem}.result-item.success{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.result-item.error{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}.result-item.info{background:#dbeafe;color:#1e40af;border:1px solid #bfdbfe}.result-item.warning{background:#fef3c7;color:#92400e;border:1px solid #fed7aa}.metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:20px 0}.metric-card{background:#fff;padding:20px;border-radius:8px;text-align:center;border:1px solid #e2e8f0}.metric-value{font-size:2rem;font-weight:700;color:#1e40af}.metric-label{color:#64748b;font-size:.9rem;margin-top:4px}.controls-panel{background:#fff;padding:24px;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,.1);margin-bottom:24px}.controls-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}.control-group{display:flex;flex-direction:column;gap:8px}.control-group label{font-weight:500;color:#374151}.control-group input,.control-group select{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:.9rem}.progress-bar{width:100%;height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin:12px 0}.progress-fill{height:100%;background:linear-gradient(90deg,#3b82f6,#1d4ed8);transition:width .3s ease;width:0%}.keyboard-hint{background:#1f2937;color:#fff;padding:12px 16px;border-radius:8px;font-family:Monaco,Menlo,monospace;font-size:.85rem;margin:16px 0}.performance-chart{height:200px;background:#fff;border:1px solid #e2e8f0;border-radius:8px;margin:16px 0;position:relative;overflow:hidden}@media (max-width:768px){.test-grid{grid-template-columns:1fr}.controls-grid{grid-template-columns:1fr}.header h1{font-size:2rem}}@media (prefers-color-scheme:dark){body{background:#0f172a;color:#e2e8f0}.controls-panel,.header,.metric-card,.test-section{background:#1e293b;border-color:#334155}.status-panel{background:#334155}.results-container{background:#1e293b;border-color:#334155}}</style></head><body><div class=test-container><div class=header><h1>🎤 Voice Assistant Test Suite</h1><p>Comprehensive testing environment for all voice agent features</p></div><div class=controls-panel><h3>Test Configuration</h3><div class=controls-grid><div class=control-group><label for=test-theme>Theme</label> <select id=test-theme><option value=auto>Auto</option><option value=light>Light</option><option value=dark>Dark</option></select></div><div class=control-group><label for=test-position>Position</label> <select id=test-position><option value=bottom-right>Bottom Right</option><option value=bottom-left>Bottom Left</option><option value=top-right>Top Right</option><option value=top-left>Top Left</option></select></div><div class=control-group><label for=auto-minimize>Auto Minimize</label> <select id=auto-minimize><option value=true>Enabled</option><option value=false>Disabled</option></select></div><div class=control-group><label for=test-speed>Test Speed</label> <select id=test-speed><option value=normal>Normal</option><option value=fast>Fast</option><option value=slow>Slow</option></select></div></div></div><div class=metrics-grid><div class=metric-card><div class=metric-value id=tests-passed>0</div><div class=metric-label>Tests Passed</div></div><div class=metric-card><div class=metric-value id=tests-failed>0</div><div class=metric-label>Tests Failed</div></div><div class=metric-card><div class=metric-value id=coverage-percent>0%</div><div class=metric-label>Coverage</div></div><div class=metric-card><div class=metric-value id=avg-response-time>0ms</div><div class=metric-label>Avg Response</div></div></div><div class=test-grid><div class=test-section><h2>Push-to-Talk Functionality</h2><button class=test-button onclick=testMicrophoneButton()>Test Mic Button</button> <button class=test-button onclick=testSpacebarToggle()>Test Spacebar</button> <button class=test-button onclick=testVisualStates()>Test Visual States</button> <button class=test-button onclick=testKeyboardShortcuts()>Test Shortcuts</button><div class=results-container id=ptt-results></div></div><div class=test-section><h2>Transcript Display</h2><button class=test-button onclick=testUserMessages()>Test User Messages</button> <button class=test-button onclick=testAIMessages()>Test AI Messages</button> <button class=test-button onclick=testMessageFormatting()>Test Formatting</button> <button class=test-button onclick=testScrollBehavior()>Test Scrolling</button><div class=results-container id=transcript-results></div></div><div class=test-section><h2>Voice Activity Visualization</h2><button class=test-button onclick=testAudioLevels()>Test Audio Levels</button> <button class=test-button onclick=testWaveformAnimation()>Test Waveform</button> <button class=test-button onclick=testVoiceDetection()>Test Voice Detection</button> <button class=test-button onclick=testVisualizationPerf()>Test Performance</button><div class=results-container id=voice-activity-results></div></div><div class=test-section><h2>Text Input Functionality</h2><button class=test-button onclick=testTypingInput()>Test Typing</button> <button class=test-button onclick=testEnterKey()>Test Enter Key</button> <button class=test-button onclick=testConnectionStates()>Test Connection</button> <button class=test-button onclick=testInputValidation()>Test Validation</button><div class=results-container id=text-input-results></div></div><div class=test-section><h2>Modern UI/UX</h2><button class=test-button onclick=testAnimations()>Test Animations</button> <button class=test-button onclick=testResponsiveDesign()>Test Responsive</button> <button class=test-button onclick=testDarkMode()>Test Dark Mode</button> <button class=test-button onclick=testAccessibility()>Test A11y</button><div class=results-container id=uiux-results></div></div><div class=test-section><h2>Error Handling</h2><button class="test-button danger" onclick=testMicPermissionError()>Test Mic Error</button> <button class="test-button danger" onclick=testConnectionError()>Test Connection</button> <button class="test-button danger" onclick=testRecoveryMechanisms()>Test Recovery</button> <button class=test-button onclick=testErrorMessages()>Test Messages</button><div class=results-container id=error-results></div></div><div class=test-section><h2>Settings & Features</h2><button class=test-button onclick=testMuteToggle()>Test Mute</button> <button class=test-button onclick=testVoiceActivation()>Test Activation</button> <button class=test-button onclick=testSettingsPersistence()>Test Persistence</button> <button class=test-button onclick=testCustomization()>Test Customization</button><div class=results-container id=settings-results></div></div><div class=test-section><h2>Performance & Analytics</h2><button class=test-button onclick=testLoadingTime()>Test Loading</button> <button class=test-button onclick=testMemoryUsage()>Test Memory</button> <button class=test-button onclick=testEventTracking()>Test Analytics</button> <button class=test-button onclick=runBenchmarks()>Run Benchmarks</button><div class=results-container id=performance-results></div></div></div><div class=status-panel><h3>Quick Actions</h3><button class="test-button success" onclick=runAllTests()>🚀 Run All Tests</button> <button class="test-button secondary" onclick=clearResults()>🧹 Clear Results</button> <button class=test-button onclick=exportResults()>📊 Export Results</button> <button class=test-button onclick=resetVoiceAgent()>🔄 Reset Agent</button></div><div class=progress-bar><div class=progress-fill id=test-progress></div></div><div class=keyboard-hint><strong>Keyboard Shortcuts:</strong> Space = Toggle Voice | Escape = Close Panel | Tab = Navigate | R = Run Tests | C = Clear</div><div class=performance-chart id=performance-chart><canvas height=200 id=perf-canvas width=100%></canvas></div></div><div class="bottom-right voice-assistant-widget" id=voice-assistant-widget data-auto-minimize=true data-theme=auto><div class=voice-fab id=voice-fab><button class=voice-fab-button aria-label="Open voice assistant">🎤</button></div><div class="hidden voice-widget-panel" id=voice-widget-panel><div class=voice-header><div class=voice-status-indicator></div><div id=voice-status-text>Ready to talk</div><button aria-label="Minimize panel" id=voice-minimize-btn>×</button></div><div class=voice-controls><button class=voice-main-button aria-label="Start/stop listening" id=voice-main-btn><div class=voice-pulse-ring></div>🎤</button> <button aria-label="Toggle mute" id=voice-mute-btn><svg fill=currentColor height=16 viewBox="0 0 20 20" width=16><path clip-rule=evenodd d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.794L4.168 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.168l4.215-3.794z" fill-rule=evenodd /></svg></button> <button aria-label="Toggle voice activation" id=voice-activation-toggle>🔄</button></div><canvas height=60 id=voice-waveform-canvas width=200 aria-label="Audio visualization"></canvas><div class=voice-transcript-container aria-label="Conversation transcript" aria-live=polite></div><button class=voice-cta-button id=voice-cta-btn>📅 Schedule Call</button><div class=voice-keyboard-hint id=voice-keyboard-hint>Press Space to talk</div></div></div><script type=module>import VoiceAssistantCore from"./src/components/voice-agent/voice-assistant-core.js";let testMetrics={passed:0,failed:0,total:0,coverage:0,responseTime:[]},testStartTime=0,voiceAssistant=null;async function initializeVoiceAssistant(){try{voiceAssistant=new VoiceAssistantCore,await voiceAssistant.initialize(),window.VoiceAssistantCore=voiceAssistant,logResult("initialization","Voice assistant initialized successfully","success")}catch(e){logResult("initialization",`Initialization failed: ${e.message}`,"error")}}function logResult(e,t,s="info"){const i=document.getElementById(`${e}-results`)||document.getElementById("performance-results");if(i){const e=document.createElement("div");e.className=`result-item ${s}`,e.innerHTML=`\n                    <span>${"success"===s?"✅":"error"===s?"❌":"warning"===s?"⚠️":"ℹ️"}</span>\n                    <span>${t}</span>\n                    <small>${(new Date).toLocaleTimeString()}</small>\n                `,i.appendChild(e),i.scrollTop=i.scrollHeight}"success"===s&&testMetrics.passed++,"error"===s&&testMetrics.failed++,testMetrics.total++,updateMetrics()}function updateMetrics(){if(document.getElementById("tests-passed").textContent=testMetrics.passed,document.getElementById("tests-failed").textContent=testMetrics.failed,document.getElementById("coverage-percent").textContent=Math.round(testMetrics.passed/testMetrics.total*100)+"%",testMetrics.responseTime.length>0){const e=testMetrics.responseTime.reduce(((e,t)=>e+t),0)/testMetrics.responseTime.length;document.getElementById("avg-response-time").textContent=Math.round(e)+"ms"}const e=(testMetrics.passed+testMetrics.failed)/Math.max(testMetrics.total,1)*100;document.getElementById("test-progress").style.width=e+"%"}async function measureTest(e,t,s){const i=performance.now();try{await e();const n=performance.now()-i;testMetrics.responseTime.push(n),logResult(t,`${s} (${Math.round(n)}ms)`,"success")}catch(e){const n=performance.now()-i;logResult(t,`${s} failed: ${e.message} (${Math.round(n)}ms)`,"error")}}window.testMicrophoneButton=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e=voiceAssistant.state.isListening;if(document.getElementById("voice-main-btn").click(),await new Promise((e=>setTimeout(e,100))),voiceAssistant.state.isListening===e)throw new Error("Button click did not change listening state")}),"ptt","Microphone button click test")},window.testSpacebarToggle=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e=voiceAssistant.state.isExpanded,t=new KeyboardEvent("keydown",{code:"Space",bubbles:!0});if(document.body.dispatchEvent(t),await new Promise((e=>setTimeout(e,100))),voiceAssistant.state.isExpanded===e)throw new Error("Spacebar did not toggle panel state")}),"ptt","Spacebar toggle test")},window.testVisualStates=async()=>{await measureTest((async()=>{const e=document.getElementById("voice-main-btn"),t=document.querySelector(".voice-status-indicator");if(!e||!t)throw new Error("Required UI elements not found");if(!e.classList.length)throw new Error("Main button missing state classes")}),"ptt","Visual states test")},window.testKeyboardShortcuts=async()=>{await measureTest((async()=>{const e=new KeyboardEvent("keydown",{code:"Escape",bubbles:!0});if(voiceAssistant&&voiceAssistant.state.isExpanded&&(document.dispatchEvent(e),await new Promise((e=>setTimeout(e,100))),voiceAssistant.state.isExpanded))throw new Error("Escape key did not close panel")}),"ptt","Keyboard shortcuts test")},window.testUserMessages=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e={role:"user",content:"Test user message for display verification",timestamp:(new Date).toISOString()};voiceAssistant.handleMessageReceived(e);if(0===document.querySelectorAll(".user-message").length)throw new Error("User message not displayed in transcript")}),"transcript","User message display test")},window.testAIMessages=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e={role:"assistant",content:"Test AI response message",timestamp:(new Date).toISOString()};voiceAssistant.handleMessageReceived(e);if(0===document.querySelectorAll(".assistant-message").length)throw new Error("AI message not displayed in transcript")}),"transcript","AI message display test")},window.testMessageFormatting=async()=>{await measureTest((async()=>{const e=document.querySelector(".voice-transcript-container");if(!e)throw new Error("Transcript container not found");e.querySelectorAll(".voice-message").forEach((e=>{if(!e.querySelector(".text-xs"))throw new Error("Message missing timestamp formatting")}))}),"transcript","Message formatting test")},window.testScrollBehavior=async()=>{await measureTest((async()=>{const e=document.querySelector(".voice-transcript-container");if(!e)throw new Error("Transcript container not found");for(let e=0;e<5;e++)voiceAssistant.handleMessageReceived({role:e%2==0?"user":"assistant",content:`Test message ${e} for scroll behavior`,timestamp:(new Date).toISOString()});if(e.scrollTop<e.scrollHeight-e.clientHeight-10)throw new Error("Transcript did not auto-scroll to bottom")}),"transcript","Scroll behavior test")},window.testAudioLevels=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e=document.getElementById("voice-waveform-canvas");if(!e)throw new Error("Waveform canvas not found");const t=e.getContext("2d"),s=t.stroke;let i=!1;if(t.stroke=()=>{i=!0,s.call(t)},voiceAssistant.updateAudioVisualization(.8),!i)throw new Error("Canvas stroke not called during visualization update")}),"voice-activity","Audio levels test")},window.testWaveformAnimation=async()=>{await measureTest((async()=>{const e=document.getElementById("voice-waveform-canvas");if(!e)throw new Error("Waveform canvas not found");if(200!==e.width||60!==e.height)throw new Error("Canvas dimensions incorrect");for(let e of[.1,.5,.9])voiceAssistant.updateAudioVisualization(e)}),"voice-activity","Waveform animation test")},window.testVoiceDetection=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e=document.querySelector(".voice-status-indicator");if(!e)throw new Error("Status indicator not found");if(voiceAssistant.handleVoiceActivity(!0),!e.classList.contains("listening"))throw new Error("Status indicator not updated for voice activity");if(voiceAssistant.handleVoiceActivity(!1),e.classList.contains("listening"))throw new Error("Status indicator not cleared after voice activity stopped")}),"voice-activity","Voice detection test")},window.testVisualizationPerf=async()=>{await measureTest((async()=>{const e=performance.now();for(let e=0;e<100;e++)voiceAssistant.updateAudioVisualization(Math.random());const t=performance.now()-e;if(t>100)throw new Error(`Visualization performance too slow: ${t}ms for 100 updates`)}),"voice-activity","Visualization performance test")},window.testMicPermissionError=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");if(voiceAssistant.handleError({type:"microphone_permission_denied",message:"Permission denied for microphone",recoverable:!0}),!voiceAssistant.state.errorState)throw new Error("Error state not set");if(!document.getElementById("voice-status-text").textContent.includes("Microphone access denied"))throw new Error("Error message not displayed correctly")}),"error","Microphone permission error test")},window.testConnectionError=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");voiceAssistant.handleError({type:"connection_failed",message:"Network connection failed",recoverable:!0});if(!document.querySelector(".voice-error-message"))throw new Error("Error message container not created")}),"error","Connection error test")},window.testMuteToggle=async()=>{await measureTest((async()=>{if(!voiceAssistant)throw new Error("Voice assistant not initialized");const e=voiceAssistant.state.isMuted;if(voiceAssistant.toggleMute(),voiceAssistant.state.isMuted===e)throw new Error("Mute state not toggled");if(voiceAssistant.toggleMute(),voiceAssistant.state.isMuted!==e)throw new Error("Mute state not restored")}),"settings","Mute toggle test")},window.testAnimations=async()=>{await measureTest((async()=>{const e=document.getElementById("voice-widget-panel");if(!e)throw new Error("Voice panel not found");if(voiceAssistant.expandPanel(),!e.classList.contains("visible"))throw new Error("Panel not marked as visible after expand");if(voiceAssistant.minimizePanel(),!e.classList.contains("hidden"))throw new Error("Panel not marked as hidden after minimize")}),"uiux","Animations test")},window.testDarkMode=async()=>{await measureTest((async()=>{const e=document.getElementById("voice-assistant-widget").dataset.theme;if(!["auto","light","dark"].includes(e))throw new Error("Invalid theme configuration")}),"uiux","Dark mode support test")},window.testAccessibility=async()=>{await measureTest((async()=>{const e=voiceAssistant.announceRegion;if(!e)throw new Error("Screen reader announcement region not found");if("polite"!==e.getAttribute("aria-live"))throw new Error("Announcement region missing proper ARIA attributes");if(voiceAssistant.announce("Test accessibility announcement"),"Test accessibility announcement"!==e.textContent)throw new Error("Announcement not properly set")}),"uiux","Accessibility test")},window.runAllTests=async()=>{const e=["testMicrophoneButton","testSpacebarToggle","testVisualStates","testKeyboardShortcuts","testUserMessages","testAIMessages","testMessageFormatting","testScrollBehavior","testAudioLevels","testWaveformAnimation","testVoiceDetection","testMicPermissionError","testConnectionError","testMuteToggle","testAnimations","testDarkMode","testAccessibility"];logResult("performance","Starting comprehensive test suite...","info");for(const t of e)try{await window[t](),await new Promise((e=>setTimeout(e,100)))}catch(e){logResult("performance",`Test ${t} failed: ${e.message}`,"error")}logResult("performance","All tests completed!","success")},window.clearResults=()=>{document.querySelectorAll(".results-container").forEach((e=>{e.innerHTML=""})),testMetrics={passed:0,failed:0,total:0,coverage:0,responseTime:[]},updateMetrics()},window.resetVoiceAgent=async()=>{voiceAssistant&&await voiceAssistant.cleanup(),await initializeVoiceAssistant(),logResult("performance","Voice agent reset successfully","success")},document.addEventListener("keydown",(e=>{if("INPUT"!==e.target.tagName&&"SELECT"!==e.target.tagName)switch(e.key.toLowerCase()){case"r":e.preventDefault(),runAllTests();break;case"c":e.preventDefault(),clearResults()}})),document.addEventListener("DOMContentLoaded",(()=>{initializeVoiceAssistant(),logResult("performance","Test suite initialized","success")})),document.getElementById("test-theme").addEventListener("change",(e=>{document.getElementById("voice-assistant-widget").dataset.theme=e.target.value,logResult("settings",`Theme changed to ${e.target.value}`,"info")})),document.getElementById("test-position").addEventListener("change",(e=>{document.getElementById("voice-assistant-widget").className=`voice-assistant-widget ${e.target.value}`,logResult("settings",`Position changed to ${e.target.value}`,"info")})),document.getElementById("auto-minimize").addEventListener("change",(e=>{document.getElementById("voice-assistant-widget").dataset.autoMinimize=e.target.value,logResult("settings","Auto-minimize "+("true"===e.target.value?"enabled":"disabled"),"info")})),window.testFunctions={testMicrophoneButton:testMicrophoneButton,testSpacebarToggle:testSpacebarToggle,testVisualStates:testVisualStates,testKeyboardShortcuts:testKeyboardShortcuts,testUserMessages:testUserMessages,testAIMessages:testAIMessages,testMessageFormatting:testMessageFormatting,testScrollBehavior:testScrollBehavior,testAudioLevels:testAudioLevels,testWaveformAnimation:testWaveformAnimation,testVoiceDetection:testVoiceDetection,testMicPermissionError:testMicPermissionError,testConnectionError:testConnectionError,testMuteToggle:testMuteToggle,testAnimations:testAnimations,testDarkMode:testDarkMode,testAccessibility:testAccessibility}</script><link href=./src/components/voice-agent/voice-assistant.css rel=stylesheet></body></html>