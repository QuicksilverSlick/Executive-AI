<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><title>React Hooks Fix Test</title><style>body{font-family:Arial,sans-serif;padding:20px;background-color:#f5f5f5}.test-container{max-width:800px;margin:0 auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1)}.test-result{padding:10px;margin:10px 0;border-radius:4px}.success{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.error{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.info{background-color:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}button{padding:10px 20px;margin:5px;border:none;border-radius:4px;cursor:pointer;font-size:14px}.btn-primary{background-color:#007bff;color:#fff}.btn-secondary{background-color:#6c757d;color:#fff}.btn-danger{background-color:#dc3545;color:#fff}#console-output{background-color:#1e1e1e;color:#d4d4d4;padding:15px;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:12px;height:300px;overflow-y:auto;margin-top:20px}</style></head><body><div class=test-container><h1>React Hooks Error Fix Verification</h1><p>This test verifies that the WebRTC Voice Assistant no longer throws "Invalid hook call" errors during page refresh.</p><div class="info test-result"><strong>Test Status:</strong> <span id=test-status>Initializing...</span></div><div><button class=btn-primary onclick=simulatePageRefresh()>üîÑ Simulate Page Refresh (F5)</button> <button class=btn-secondary onclick=forceRerender()>üîÅ Force Component Rerender</button> <button class=btn-danger onclick=clearResults()>üßπ Clear Results</button></div><div id=test-results></div><h3>Console Output</h3><div id=console-output></div></div><script crossorigin src=https://unpkg.com/react@18/umd/react.development.js></script><script crossorigin src=https://unpkg.com/react-dom@18/umd/react-dom.development.js></script><script>const originalConsole={log:console.log,error:console.error,warn:console.warn},consoleOutput=document.getElementById("console-output");let testResults=[];function addToConsole(e,...t){const s=(new Date).toLocaleTimeString(),o=t.map((e=>"object"==typeof e?JSON.stringify(e):e)).join(" ");consoleOutput.innerHTML+=`<div style="color: ${"error"===e?"#ff6b6b":"warn"===e?"#ffa500":"#d4d4d4"}">[${s}] ${e.toUpperCase()}: ${o}</div>`,consoleOutput.scrollTop=consoleOutput.scrollHeight,originalConsole[e](...t)}console.log=(...e)=>addToConsole("log",...e),console.error=(...e)=>addToConsole("error",...e),console.warn=(...e)=>addToConsole("warn",...e);let hasReactError=!1,hasHookError=!1;function addTestResult(e,t,s="info"){const o=document.getElementById("test-results"),r=document.createElement("div");r.className=`test-result ${s}`,r.innerHTML=`<strong>${e}:</strong> ${t}`,o.appendChild(r),testResults.push({timestamp:(new Date).toISOString(),title:e,message:t,type:s}),updateTestStatus()}function updateTestStatus(){const e=document.getElementById("test-status");hasHookError?(e.textContent="‚ùå FAILED - Hook errors detected",e.parentElement.className="test-result error"):hasReactError?(e.textContent="‚ö†Ô∏è WARNING - React errors detected (but no hook errors)",e.parentElement.className="test-result error"):testResults.length>0?(e.textContent="‚úÖ PASSED - No hook errors detected",e.parentElement.className="test-result success"):(e.textContent="Running tests...",e.parentElement.className="test-result info")}function simulatePageRefresh(){addTestResult("üîÑ Simulating Page Refresh","Testing component recreation...","info"),hasReactError=!1,hasHookError=!1;try{if("undefined"!=typeof window){localStorage.getItem("voice_assistant_preferences"),sessionStorage.getItem("webrtc_session_token");addTestResult("‚úÖ LocalStorage Access","Successfully accessed preferences during initialization","success"),addTestResult("‚úÖ SessionStorage Access","Successfully accessed session data during initialization","success")}setTimeout((()=>{hasHookError||addTestResult("‚úÖ Hook Initialization Test","No hook errors detected after 1 second","success")}),1e3),setTimeout((()=>{hasHookError||addTestResult("‚úÖ Hook Stability Test","No hook errors detected after 3 seconds","success")}),3e3)}catch(e){addTestResult("‚ùå Refresh Simulation Failed",e.message,"error")}}function forceRerender(){addTestResult("üîÅ Force Rerender Test","Testing component rerender stability...","info");let e=0;const t=setInterval((()=>{e++;try{"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("test-rerender",{detail:e})),e>=10&&(clearInterval(t),hasHookError||addTestResult("‚úÖ Rerender Stability Test","Completed 10 rerenders without hook errors","success"))}catch(e){clearInterval(t),addTestResult("‚ùå Rerender Test Failed",e.message,"error")}}),100)}function clearResults(){document.getElementById("test-results").innerHTML="",document.getElementById("console-output").innerHTML="",testResults=[],hasReactError=!1,hasHookError=!1,document.getElementById("test-status").textContent="Cleared - Ready for testing",document.getElementById("test-status").parentElement.className="test-result info"}window.addEventListener("error",(e=>{const t=e.error;t&&t.message&&(t.message.includes("Invalid hook call")||t.message.includes("Cannot read properties of null (reading 'useState')")?(hasHookError=!0,addTestResult("‚ùå React Hook Error Detected",t.message,"error")):t.message.includes("React")&&(hasReactError=!0,addTestResult("‚ö†Ô∏è React Error Detected",t.message,"error")))})),addTestResult("üöÄ Test Initialized","Ready to test React hooks error fix","info"),setTimeout((()=>{simulatePageRefresh()}),1e3),console.log("React Hooks Fix Test loaded successfully")</script></body></html>