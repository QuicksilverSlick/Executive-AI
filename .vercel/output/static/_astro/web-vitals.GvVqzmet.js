let e=-1;const t=t=>{addEventListener("pageshow",(n=>{n.persisted&&(e=n.timeStamp,t(n))}),!0)},n=(e,t,n,i)=>{let r,s;return o=>{t.value>=0&&(o||i)&&(s=t.value-(r??0),(s||void 0===r)&&(r=t.value,t.delta=s,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},i=e=>{requestAnimationFrame((()=>requestAnimationFrame((()=>e()))))},r=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},s=()=>{const e=r();return e?.activationStart??0},o=(t,n=-1)=>{const i=r();let o="navigate";return e>=0?o="back-forward-cache":i&&(document.prerendering||s()>0?o="prerender":document.wasDiscarded?o="restore":i.type&&(o=i.type.replace(/_/g,"-"))),{name:t,value:n,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:o}},a=new WeakMap;function d(e,t){return a.get(e)||a.set(e,new t),a.get(e)}class l{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const t=this.o[0],n=this.o.at(-1);this.i&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const c=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const i=new PerformanceObserver((e=>{Promise.resolve().then((()=>{t(e.getEntries())}))}));return i.observe({type:e,buffered:!0,...n}),i}}catch{}},h=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let u=-1;const m=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,p=e=>{"hidden"===document.visibilityState&&u>-1&&(u="visibilitychange"===e.type?e.timeStamp:0,g())},v=()=>{addEventListener("visibilitychange",p,!0),addEventListener("prerenderingchange",p,!0)},g=()=>{removeEventListener("visibilitychange",p,!0),removeEventListener("prerenderingchange",p,!0)},T=()=>{if(u<0){const e=s(),n=document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((t=>"hidden"===t.name&&t.startTime>e))[0]?.startTime;u=n??m(),v(),t((()=>{setTimeout((()=>{u=m(),v()}))}))}return{get firstHiddenTime(){return u}}},f=e=>{document.prerendering?addEventListener("prerenderingchange",(()=>e()),!0):e()},y=[1800,3e3],b=(e,r={})=>{f((()=>{const a=T();let d,l=o("FCP");const h=c("paint",(e=>{for(const t of e)"first-contentful-paint"===t.name&&(h.disconnect(),t.startTime<a.firstHiddenTime&&(l.value=Math.max(t.startTime-s(),0),l.entries.push(t),d(!0)))}));h&&(d=n(e,l,y,r.reportAllChanges),t((t=>{l=o("FCP"),d=n(e,l,y,r.reportAllChanges),i((()=>{l.value=performance.now()-t.timeStamp,d(!0)}))})))}))},C=[.1,.25],L=(e,r={})=>{b(h((()=>{let s,a=o("CLS",0);const h=d(r,l),u=e=>{for(const t of e)h.h(t);h.i>a.value&&(a.value=h.i,a.entries=h.o,s())},m=c("layout-shift",u);m&&(s=n(e,a,C,r.reportAllChanges),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(u(m.takeRecords()),s(!0))})),t((()=>{h.i=0,a=o("CLS",0),s=n(e,a,C,r.reportAllChanges),i((()=>s()))})),setTimeout(s))})))};let P=0,E=1/0,S=0;const A=e=>{for(const t of e)t.interactionId&&(E=Math.min(E,t.interactionId),S=Math.max(S,t.interactionId),P=S?(S-E)/7+1:0)};let I;const w=()=>I?P:performance.interactionCount??0;let M=0;class F{u=[];l=new Map;m;v;p(){M=w(),this.u.length=0,this.l.clear()}P(){const e=Math.min(this.u.length-1,Math.floor((w()-M)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&"first-input"!==e.entryType)return;const t=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>t.T){if(n?e.duration>n.T?(n.entries=[e],n.T=e.duration):e.duration===n.T&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],T:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort(((e,t)=>t.T-e.T)),this.u.length>10){const e=this.u.splice(10);for(const t of e)this.l.delete(t.id)}this.v?.(n)}}}const k=e=>{const t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=h(e),document.addEventListener("visibilitychange",e,{once:!0}),t((()=>{e(),document.removeEventListener("visibilitychange",e)})))},B=[200,500],x=(e,i={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&f((()=>{"interactionCount"in performance||I||(I=c("event",A,{type:"event",buffered:!0,durationThreshold:0}));let r,s=o("INP");const a=d(i,F),l=e=>{k((()=>{for(const t of e)a.h(t);const t=a.P();t&&t.T!==s.value&&(s.value=t.T,s.entries=t.entries,r())}))},h=c("event",l,{durationThreshold:i.durationThreshold??40});r=n(e,s,B,i.reportAllChanges),h&&(h.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(l(h.takeRecords()),r(!0))})),t((()=>{a.p(),s=o("INP"),r=n(e,s,B,i.reportAllChanges)})))}))};class N{m;h(e){this.m?.(e)}}const R=[2500,4e3],q=(e,r={})=>{f((()=>{const a=T();let l,u=o("LCP");const m=d(r,N),p=e=>{r.reportAllChanges||(e=e.slice(-1));for(const t of e)m.h(t),t.startTime<a.firstHiddenTime&&(u.value=Math.max(t.startTime-s(),0),u.entries=[t],l())},v=c("largest-contentful-paint",p);if(v){l=n(e,u,R,r.reportAllChanges);const s=h((()=>{p(v.takeRecords()),v.disconnect(),l(!0)}));for(const e of["keydown","click","visibilitychange"])addEventListener(e,(()=>k(s)),{capture:!0,once:!0});t((t=>{u=o("LCP"),l=n(e,u,R,r.reportAllChanges),i((()=>{u.value=performance.now()-t.timeStamp,l(!0)}))}))}}))},H=[800,1800],D=e=>{document.prerendering?f((()=>D(e))):"complete"!==document.readyState?addEventListener("load",(()=>D(e)),!0):setTimeout(e)},O=(e,i={})=>{let a=o("TTFB"),d=n(e,a,H,i.reportAllChanges);D((()=>{const c=r();c&&(a.value=Math.max(c.responseStart-s(),0),a.entries=[c],d(!0),t((()=>{a=o("TTFB",0),d=n(e,a,H,i.reportAllChanges),d(!0)})))}))};export{C as CLSThresholds,y as FCPThresholds,B as INPThresholds,R as LCPThresholds,H as TTFBThresholds,L as onCLS,b as onFCP,x as onINP,q as onLCP,O as onTTFB};